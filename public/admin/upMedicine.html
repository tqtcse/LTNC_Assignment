<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="upMedicine.css">
        <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <link rel="stylesheet" href="./assets/img/">
    </head>
    <body>   
        <div id="Header">
            <div class="row">
                <div class="col-lg-2 col-6">
                    <div class="Logo">
                        <h1>
                            <a title="BKMEET" alt="BKMEET VIETNAM" href="../index1.html">BKMEET</a>
                        </h1>
                    </div>
                </div>
                <div class="col-lg-10 col-6">
                    <div class="main-menu">
                        <ul class="nav">
                            <li> <b>ADMIN</b>
                            </li>
                            <li>
                                <a href="adminFunctions.html">
                                    Home
                                    <small>Main</small>
                                </a>
                                
                            </li>
                            <li>
                                <a href="makeAdmin.html">Create Account
                                    <small>Account</small>
                                </a>
                                
                            </li>
                            <li>
                                <a href="upMedicine.html">Upload Medicine
                                    <small>Medicine</small>
                                </a>
                                  
                            </li>
                            <li>
                                <a href="upTool.html">Upload Tool
                                    <small>Tool</small>
                                </a>
                                  
                            </li>
                            <li>
                                <a href="StaffList.html">Staff List
                                    <small>Staff</small>
                                </a>
                               
                            </li>
                            <li>
                                <a href="Profit.html">Profit
                                    <small>Profit</small>
                                </a>
                               
                            </li>
                            <!-- <li>
                                <a href="home.html">
                                    <i class="fa-solid fa-user-minus"></i>
                                </a>
                            </li> -->
                            
                        </ul>
                    </div>
                </div>

            </div>

            <div class="Header-line">
            </div>
        </div>

        
        <div id="nall">
            <div id="all">
                <div> <h2>Save Medicine To Database</h2></div> 
            <!-- <input type="text" id="specialist" list="CLINIC_LIST" placeholder="Choose a clinic"> -->
            <div class="form-field">
                <i class='bx bx-briefcase-alt'></i>
                <input type="text" class="form-input" placeholder=" " id="specialist" list="CLINIC_LIST" >
                <label for="name" class="form-label">Choose a clinic</label>
            </div> 
            <datalist id="CLINIC_LIST">
                <option value="Ophthalmology">
                <option value="Otorhinolaryngology">
                <option value="Dermatology">
                </option>
            </datalist>
            <div id="medicineInfor" style="display: none;">
                <div id="medicineInfor1">
                     <!-- <div>Medicine Name
                   <div> <input type="text" id="medicineName" placeholder="Name"></div>
                </div> -->
                <div class="form-field">
                    <i class='bx bxs-capsule'></i>
                    <input type="text" class="form-input" placeholder=" " id="medicineName"  >
                    <label for="name" class="form-label">Medicine Name</label>
                </div> 
                <!-- <div> ID Medicine
                    <div><input type="text" id="medicineID" placeholder="Medical ID"></div> -->
                <div class="form-field">
                    <i class='bx bx-band-aid'></i>
                    <input type="text" class="form-input" placeholder=" " id="medicineID"  >
                    <label for="name" class="form-label">Medical ID</label>
                </div>  
                <!-- <div>Quantity
                    <div><input type="number" id="quantity" placeholder="Quantity"></div>
                </div> -->
                <div class="form-field">
                    <input type="number" class="form-input" placeholder=" " id="quantity"  >
                    <label for="name" class="form-label">Quantity</label>
                </div>
    
                <!-- <div>
                    <div><input type="text" id="place" list="PlaceList" placeholder="Place To Store"></div>
                    <datalist id="PlaceList">
                        <option value="B1">
                        <option value="B2">
                        <option value="B3">
                        </option>
                    </datalist>
                    </div> -->
                <div>
                    <div class="form-field">
                        <i class='bx bx-location-plus' ></i>
                        <input type="text" class="form-input" placeholder=" " id="place" list="PlaceList"  >
                        <label for="name" class="form-label">Place To Store</label>
                    </div>
                    <datalist id="PlaceList">
                        <option value="B1">
                        <option value="B2">
                        <option value="B3">
                    </option>
                </div>
                <!-- <div> Price
                    <div><input type="text" id="Price" placeholder="Price"?></div>
                </div> -->
                <div class="form-field">
                    <i class='bx bx-money-withdraw' ></i>
                    <input type="text" class="form-input" placeholder=" " id="Price"  >
                    <label for="name" class="form-label">Price</label>
                </div>
                <!-- <div>
                    Manufacturing Date
                    <div> <input type="date" id="MFD"></div>
                </div> -->
                <div class="form-field">
                    <input type="date" class="form-input" placeholder=" " id="MFD"  >
                    <label for="name" class="form-label">Manufacturing Date</label>
                </div>
                <!-- <div>Expire Date
                    <div><input type="date" id="expire" placeholder="Expire"></div>
                </div> -->
                <div class="form-field">
                    <input type="date" class="form-input" placeholder=" " id="expire"  >
                    <label for="name" class="form-label">Expire Date</label>
                </div>
                <button onclick="submitMedicine()">Update</button>
                </div>
                <div><h3>Medicine List</h3></div>
               <div id="ButtonCanUse">
                    <!-- <input type="text" id="FindMedicine" placeholder="Find Medicine By ID"> -->    
                    <div class="form-field">
                        <i class='bx bx-search'></i>
                        <input type="text" class="form-input" placeholder=" " id="FindMedicine"  >
                        <label for="name" class="form-label">Find Medicine By ID</label>
                    </div>
                    <button onclick="findMedicine()">Medicine List</button>
               </div>
               <div id="MedicineDiv">
               </div>
               <div id="EL"><h3>ExpireList</h3></div>
                <div id="Button">
                    <button onclick="findExpiredMedicine()">Expired List</button>
                </div>
                <div id="ExpireDiv"> 
                </div>   
            </div>
            </div>
        </div>
        
        <footer>
            <div class="container margin_60_35">
        <div class="row">
           <div class="col-lg-4 col-md-12">
               <p>
                   <a href="../index1.html" title="BKMEET ONLINE APPOINTMENT PLATFORM">
                       <img src="/public/assets/img/logo.jpg" alt="BKMEET INDIA'S BEST ONLINE APPOINTMENT SCHEDULING PLATFORM" width="200" height="auto" class="img-fluid">
                   </a>
               </p>
               <h5>Online Appointment Scheduling Platform</h5>
               <!-- <ul class="contacts">
                   <li><a href="https://g.page/BKMEET" target="_new"><i class="fa fa-map-marker"></i>Nasscom Startup Warehouse, Infopark Campus, Kakkanad, Kerala, India</a></li>
                   <li><a href="tel://+91 9496 947 548"><i class="fa fa-mobile-phone"></i>+91 9496 947 548</a></li>
                   <li><a href="mailto:post@BKMEET.com"><i class="fa fa-envelope"></i>post@BKMEET.com</a></li>
               </ul> -->
               <div class="follow_us">
                   <h5>Follow us</h5>
                   <ul>
                       <li><a href="../index1.html" target="_new"><i class="fab fa-facebook"></i></a></li>
                       <li><a href="../index1.html" target="_new"><i class="fab fa-twitter"></i></a></li>
                       <li><a href="../index1.html" target="_new"><i class="fab fa-linkedin"></i></a></li>
                       <li><a href="../index1.html" target="_new"><i class="fab fa-instagram"></i></a></li>
                       <!-- <li><a href="https://api.whatsapp.com/send?phone=919496947548&amp;text=BKMEET%20-%20Confirmed%20Online%20Appointment" target="_new"><i class="fab fa-whatsapp"></i></a></li>
                       <li><a href="https://youtube.com/@BKMEET" target="_new"><i class="fab fa-youtube" target="_new"></i></a></li>
                       <li><a href="https://play.google.com/store/apps/dev?id=4852298828600166862" target="_new"><i class="fab fa-android" target="_new"></i></a></li> -->
                   </ul>
               </div><br>
               <!-- <p>
                   <a href="https://play.google.com/store/apps/details?id=com.BKMEET.app" target="_new" title="BKMEET mobile app now available on Google playstore">
                       <img src="https://www.BKMEET.com/img/bnm/google-play-badge-bnm-vc-01.svg" width="120" height="36" alt="BKMEET mobile app now available on Google playstore" class="img-fluid">
                   </a>
               </p> -->
               
           </div>
           <div class="col-lg-3 col-md-4">
           
               <!-- <ul class="links">
               <li><a href="/clinicalprocedures">Clinical Procedure Scheduling</a></li>
               <li><a href="/vaccination">Vaccination</a></li>
               <li><a href="/nutritionpractice">Nutrition Practice</a></li>
               <li><a href="/compareplans">Compare Plans</a></li>
                   <li><a href="/terms">Terms of Use</a></li>
                   <li><a href="/privacy">Privacy Policy</a></li>
                   <li><a href="/personalinformationpolicy">Personal Information Policy</a></li>
                   <li><a href="/videoconsultationpolicy">Video Consultation Policy</a></li>
                   <li><a href="/trademarknotice">Trade Mark Notice</a></li>
                   <li><a href="/faq">FAQ</a></li>
                   
                   <li><a href="/limitedoffer">Special Offer</a></li>
               </ul> -->
               <p>Subscribe to BKMEET Newsletter to get Important News, Amazing Offers &amp; Inside Scoops:</p>
                <form method="post" action="" class="rd-mailform subscribe" id="subscription_mail" data-parsley-validate="" novalidate="">
                    <input type="hidden" name="form-type" value="subscribe">
                    <input id="email_id" name="email_id" data-parsley-trigger="change" required="" type="email" class="form-control" placeholder="Email">
                    <br>
                    <!-- <input type="submit" class="btn_1" value="Submit"><div class="mfInfo"></div>												  -->
                </form>
           </div>
              
           <!-- <div class="col-lg-5 col-md-5" id="homepagesection">
               <a class="btn btn-sm btn-primary" href="https://www.BKMEET.com/demo">Request BKMEET Demo</a>
               <a class="btn btn-sm btn-primary" href="https://www.BKMEET.com/career">Career@BKMEET</a>
               <a class="btn btn-sm btn-primary" href="https://www.BKMEET.com/webstories/bnm-amp-stories.html">WEBSTORIES</a>
               <h5 style="margin-top: 20px;">Your guaranteed Mobile Online Appointment</h5>
               <p>With BKMEET productivity tool, be successful in avoiding unscheduled absences. let our tool support you to be a leader in your medical practice. The best online appointment scheduling Platform enhances your practice management with online profile visibility.</p>
               
           </div> -->
           
        </div>
        <br><br>
        <!--/row-->
        <div class="row">
           <div class="col-md-12">
                             </div>
        </div>
        <br>
        <!-- <div class="row">
           <div class="col-md-12">
           
               <p>
                   <a target="_blank" href="http://www.newindianexpress.com/cities/kochi/2017/feb/08/book-n-meet-a-doctor-1568476.html"><img style="width:168px;height:21px;margin-right:25px;" alt="BKMEET startup based in Kochi featured by National media,The New IndianExpress-Startupedia" class="img-fluid" src="https://www.BKMEET.com/img/theNewIndianExpress-BKMEET-2020.png"></a>
                   
                   <a target="_blank" href="http://epaperbeta.timesofindia.com/Article.aspx?eid=31811&amp;articlexml=Startups-wake-up-to-new-avenues-30072017002046"><img style="width: 165px;height:21px;margin-right:25px" alt="BKMEET startup based in Kochi featured by National media,The Times of India-TOI-Startup feature by local correspondant" class="img-fluid" src="https://www.BKMEET.com/img/theTimesofIndia-BKMEET-2020.png"></a>
                   
                   <a target="_blank" href="https://www.vanitha.in/justin/book-in-meet-prashanthi-nadhan-article-vanitha.html"><img style="width: 127px;height:36px;" alt="BKMEET startup based in Kochi featured by National media,Vanitha-Startup feature by local correspondant" class="img-fluid" src="https://www.BKMEET.com/img/Vanitha-Manorama-BKMEET-2020.png"></a>
               
               </p>
           
           </div>
        
        </div> -->
        <hr>
        <div class="row">
           <!-- <div class="col-md-8">
               <ul id="additional_links">
                   <li><a href="https://qstat.co" target="_new" title="BKMEET QMS WITH TOKEN">QSTAT</a></li>
                   <li><a href=" http://startups.startupmission.in/c/460" class="text-transform-none" target="_blank" title="Kerala Startup Mission Certified Startup">KSUM</a></li>
                   <li><a href="https://www.startupindia.gov.in/content/sih/en/profile.Startup.59807990e4b0bed982a4ed5c.html" class="text-transform-none" target="_blank" title="Govt. of India Certified Startup">STARTUPINDIA</a></li>
               </ul>
           </div> -->
           <div class="col-md-4">
               <div id="copy">Copyright © 2024 All Rights Reserved by <a href="../index1.html">BKMEET®</a></div>
           </div>
        </div>
        </div>
        </footer>




        <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-auth.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-database.js"></script>
        <script src="../index1.js"></script>
        <script>
            document.getElementById("specialist").addEventListener('change',function(){
                MedicineInforDiv = document.getElementById("medicineInfor")
                MedicineInforDiv.style.display = 'block'
            })
            function findMedicine(){
                Id = document.getElementById("FindMedicine").value
                Clinic = document.getElementById("specialist").value
                i = 0;
                database.ref('Medicine/' + Clinic).once('value',function(snapshot){
                    snapshot.forEach((childSnapshot) => {
                        
                        childSnapshot.forEach((childSnapshot2) => {

                            childSnapshot2.forEach((childSnapshot3) => {
                               
                            
                                EXDate = childSnapshot3.val().ExpireDate

                                const EX = new Date(EXDate);
                                const currentDate = new Date()
                                
                                IdFromData = childSnapshot3.val().IdMedicine
                             
                                if ((currentDate < EX) && (Id === IdFromData)) {
                                    i = i + 1
                                    
                    ButtonDiv1 = document.getElementById('ButtonCanUse')
                    ButtonDiv1.style.display = 'none'

                    const MedInfoDiv1 = document.getElementById('MedicineDiv');
                    

                    MedInfoDiv1.style.display = 'block';
                    
                    const newDiv = document.createElement('div')


                    newDiv.innerHTML = `
                            <p>Clinic: ${childSnapshot3.val().Clinic}</p>
                            <p>Medicine Name: ${childSnapshot3.val().MedicineName}</p>
                            <p>ID Medicine: ${childSnapshot3.val().IdMedicine}</p>
                            <p>ManufacturingDate: ${childSnapshot3.val().ManufacturingDate}</p>
                            <p>Expire Date: ${childSnapshot3.val().ExpireDate}</p>
                            <p>Place: ${childSnapshot3.val().Place}</p>
                            <p>Quantity: ${childSnapshot3.val().Quantity}</p>
                            <p>Price: ${childSnapshot3.val().Price}</p>
                `;

                    const hideButton1 = document.createElement('button');
                    hideButton1.textContent = "Hide";      

                    const deleteButton1 = document.createElement('button');
                    deleteButton1.textContent = "Delete";

                    hideButton1.addEventListener('click', () => {
                    ButtonDiv1.style.display = 'block';
                    //MedInfoDiv1.style.display = 'none';
                    hideButton1.style.display = 'none'
                    deleteButton1.style.display = 'none'
                    newDiv.innerHTML = ''; 

                });
                    




                    deleteButton1.addEventListener('click', () => {
                    
                        childSnapshot3.ref.remove()
                        ButtonDiv1.style.display = 'block';
                        newDiv.innerHTML = ''
                        hideButton1.style.display = 'none'
                        deleteButton1.style.display = 'none'

                });

                
                //thêm vào chỗ này
                const buttonContainer = document.createElement('div');
                buttonContainer.id = 'buttonContainer';                
                buttonContainer.appendChild(deleteButton1);
                buttonContainer.appendChild(hideButton1);
   
                MedInfoDiv1.appendChild(newDiv);
                MedInfoDiv1.appendChild(buttonContainer);
                //MedInfoDiv1.appendChild(deleteButton1);
                //MedInfoDiv1.appendChild(hideButton1);

                    } 
                    
                            })
                        })
                    })
                })
            }
            function findExpiredMedicine(){
                i = 0
                Clinic = document.getElementById("specialist").value
                database.ref('Medicine/' + Clinic).once('value',function(snapshot){
                    snapshot.forEach((childSnapshot) => {
                        
                        childSnapshot.forEach((childSnapshot2) => {

                            childSnapshot2.forEach((childSnapshot3) => {
                               
                            
                                EXDate = childSnapshot3.val().ExpireDate

                                const EX = new Date(EXDate);
                                const currentDate = new Date()
    
                               
                                if (currentDate > EX) {
                                    i = i + 1;
                                    
                                    ButtonDiv = document.getElementById('Button')

                    ButtonDiv.style.display = 'none'

                    const MedInfoDiv = document.getElementById('ExpireDiv');
                    

                    MedInfoDiv.style.display = 'block';

                    const newDiv = document.createElement('div');
                    


                    newDiv.innerHTML = `
                            <p>Clinic: ${childSnapshot3.val().Clinic}</p>
                            <p>Medicine Name: ${childSnapshot3.val().MedicineName}</p>
                            <p>ID Medicine: ${childSnapshot3.val().IdMedicine}</p>
                            <p>ManufacturingDate: ${childSnapshot3.val().ManufacturingDate}</p>
                            <p>Expire Date: ${childSnapshot3.val().ExpireDate}</p>
                            <p>Place: ${childSnapshot3.val().Place}</p>
                            <p>Quantity: ${childSnapshot3.val().Quantity}</p>
                            <p>Price: ${childSnapshot3.val().Price}</p>
                `;

 

                    const hideButton = document.createElement('button');
                    hideButton.textContent = "Hide"; 

                    
                    const deleteButton = document.createElement('button');
                    deleteButton.textContent = "Delete";

                    hideButton.addEventListener('click', () => {
                    ButtonDiv.style.display = 'block';
                    newDiv.innerHTML = ''

                    hideButton.style.display = 'none'
                    deleteButton.style.display = 'none'
                });
                    



                    
                    deleteButton.addEventListener('click', () => {
                    
                        childSnapshot3.ref.remove()
                        ButtonDiv.style.display = 'block';
                        MedInfoDiv.style.display = 'none';
                        //findExpiredMedicine();

                });

                //thêm vào chỗ này
                const buttonContainer = document.createElement('div');
                buttonContainer.id = 'buttonContainer';
                
                buttonContainer.appendChild(deleteButton);
                buttonContainer.appendChild(hideButton);

                MedInfoDiv.appendChild(newDiv);
                MedInfoDiv.appendChild(buttonContainer);
                //MedInfoDiv.appendChild(deleteButton);
                //MedInfoDiv.appendChild(hideButton);

                    }  
                            })
                        })
                    })
                })
            }
         
            function submitMedicine(){
            
              Clinic = document.getElementById("specialist").value
              Name = document.getElementById("medicineName").value 
              Id = document.getElementById("medicineID").value
              Quantity = document.getElementById("quantity").value
              MFDs = document.getElementById("MFD").value
              Expire = document.getElementById("expire").value
              Place = document.getElementById("place").value
              Price = document.getElementById("Price").value

            const MedicineRef = firebase.database().ref('Medicine')
            MedicineRef.once('value', (snapshot) => {
                if(!snapshot.exists()){
                    var data = {
                        MedicineName : Name,
                        IdMedicine : Id,
                        Quantity : Quantity,
                        ManufacturingDate : MFDs,
                        ExpireDate : Expire,
                        Place : Place,
                        Clinic : Clinic,
                        Price : Price

                    }
                    console.log('create new Medicine')
                    firebase.database().ref('Medicine/' + Clinic + '/' + Place + '/' + Id + '/' + Expire ).set(data)
                } else {
                   database.ref('Medicine/' + Clinic + '/' + Place + '/' +  Id + '/' + Expire ).once('value',function(snapshot){
                    if(!snapshot.exists()){
                        data1 = 0;
                        const data1Number = parseInt(data1)
                        const quantityNumber = parseInt(Quantity)

                        sum = data1Number + quantityNumber

                        var data = {
                        MedicineName : Name,
                        IdMedicine : Id,
                        Quantity : sum,
                        ManufacturingDate : MFDs,
                        ExpireDate : Expire,
                        Place : Place,
                        Clinic : Clinic,
                        Price : Price

                    }
                    console.log('Add success')
                    firebase.database().ref('Medicine/' + Clinic + '/' + Place + '/' +  Id + '/' + Expire ).set(data)
                    } else {

                        data1 = snapshot.val().Quantity
                        console.log(data1)


                        const data1Number = parseInt(data1)
                        const quantityNumber = parseInt(Quantity)

                        sum = data1Number + quantityNumber

                        var data = {
                        MedicineName : Name,
                        IdMedicine : Id,
                        Quantity : sum,
                        ManufacturingDate : MFDs,
                        ExpireDate : Expire,
                        Place : Place,
                        Clinic : Clinic,
                        Price : Price

                    }
                    console.log('Add success')
                    firebase.database().ref('Medicine/' + Clinic + '/' + Place + '/' +  Id + '/' + Expire ).set(data)
                    }
                   })

                }
            })

            }
                
                firebase.auth().onAuthStateChanged(async function(user) {
                    if (user) {
                        console.log('user signed in')
                    } 
                    else {
                        console.log('user is not')
                    }
                }
                )
                
        </script>
 
    </body>
        
</html>