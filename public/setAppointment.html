<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./assets/css/setAppointment.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="./assets/img/">
</head>
<body>
    <div id="test1">
        <div id="Header">
            <div class="row">
                <div class="col-lg-2 col-6">
                    <div class="Logo">
                        <!-- <h1>
                            <a title="BKMEET India" alt="BKMEET India" href="./index1.html">BKMEET</a>
                        </h1> -->
                    </div>
                </div>
                <div class="col-lg-10 col-6">
                    <div class="main-menu">
                        <ul class="nav">
                            <li id ="HOME">
                                <a href="index1.html">
                                    Home
                                  
                                </a>
                                
                            </li>
                            <li id = "INFO">
                                <a href="patient/information.html">
                                    My Information
                                    
                                </a>
                                
                            </li>
                            <li id = "SET_APPOINTMENT">
                                <a href="setAppointment.html">
                                    Set Appoinment
                                 
                                </a>
                            
                            </li>
    
                            <li id ="LOGIN">
                                <a href="login.html">
                                    <i class="fa-solid fa-user"></i>
                                </a>
                            </li>
                            <li id ="REGISTER">
                                <a href="register.html">
                                    <i class="fa-solid fa-user-plus"></i>
                                </a>
                            </li>
    
                            <li id = "LOGOUT">
                                <a >
                                    <i class="fa-solid fa-user-minus"></i>
                                </a>
                            </li>
                            
                        </ul>
                    </div>
                </div>
            </div>
        </div>

    <div class="Container">
        <div class="main_title">
            <h1>BKMEET FEATURES</h1>
            <p>Scheduling automation you and your invitees will actually enjoy. </p>
            <div class="SetAppointment_img"></div>
        </div>

        <h2 id="form" class="Set_Appointment-title">SET APPOINTMENT</h2>
        <div class="SetAppointment_Box">
            <div class="SetAppointment_Tittle">
                <p>Notes</p>
                <p> Dear customers, please provide accurate information to receive the best service. In case of providing incorrect email & phone information, the appointment confirmation will be invalid.</p>
                <p>If you use the online appointment booking service, please make an appointment at least 24 hours before your appointment.</p>
                <p>In case of emergency or suspected dangerous symptoms, please GO DIRECTLY to the nearest clinic or medical center for timely treatment.</p>
            </div>
            <div class="SetAppointment_Content">
                <h2>Medical Register</h2>
                <p>Please fill out the form below to register for medical examination as required</p>
                <input type="text" id="full_name21" placeholder="Full name">
                <input type="text" id="gender" placeholder="Gender">
                <input type="text" id="age" placeholder="Age">
                <input type="text" id="number" placeholder="Phone Number">
                <input type="text" id="address" placeholder="Address">
                <div id="book"></div>
                    <!-- <input type="text" id="bhyt" placeholder="Health Insurance"> -->
                <label for="bhyt" id="bhyt_label">Health Insurance:</label>
                <select id="bhyt">
                <option value="Select">Yes/No</option>
                <option value="yes">Yes</option>
                <option value="no">No</option>
                </select>
                <div>
                    <input type="text" id="numberHI" placeholder="Health Insurance Number" style="display: none;"> <div></div>
                    <input type="text" id="khoa" list="khoalist" placeholder="Choose Clinic">
                    <datalist id="khoalist">
                        <option value="Ophthalmology">
                        <option value="Otorhinolaryngology">
                        <option value="Dermatology">
                        </option>
                    </datalist>
                    <input type="text" id="time" list ="timeList" placeholder="Select Appointment Time">
                    <datalist id="timeList">
                        <option value ="8:00 AM - 10:00 AM">
                        <option value ="1:00 PM - 3:00 PM">
                        <option value ="3:00 PM - 5:00 PM">
                        </option>
                    </datalist>
                </div>
                <div>
                    <input type ="date" id="date" placeholder="Date">
                </div>
                
                <div id="button_cointer">
                    <button onclick="setAppointment()">Submit</button>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="container margin_60_35">
    <div class="row">
       <div class="col-lg-4 col-md-12">
           <p>
               <a href="./index1.html" title="BKMEET ONLINE APPOINTMENT PLATFORM">
                   <img src="/public/assets/img/logo.jpg" alt="BKMEET INDIA'S BEST ONLINE APPOINTMENT SCHEDULING PLATFORM" width="200" height="auto" class="img-fluid">
               </a>
           </p>
           <h5>Online Appointment Scheduling Platform</h5>
           <!-- <ul class="contacts">
               <li><a href="https://g.page/BKMEET" target="_new"><i class="fa fa-map-marker"></i>Nasscom Startup Warehouse, Infopark Campus, Kakkanad, Kerala, India</a></li>
               <li><a href="tel://+91 9496 947 548"><i class="fa fa-mobile-phone"></i>+91 9496 947 548</a></li>
               <li><a href="mailto:post@BKMEET.com"><i class="fa fa-envelope"></i>post@BKMEET.com</a></li>
           </ul> -->
           <div class="follow_us">
               <h5>Follow us</h5>
               <ul>
                   <li><a href="./index1.html" target="_new"><i class="fab fa-facebook"></i></a></li>
                   <li><a href="./index1.html" target="_new"><i class="fab fa-twitter"></i></a></li>
                   <li><a href="./index1.html" target="_new"><i class="fab fa-linkedin"></i></a></li>
                   <li><a href="./index1.html" target="_new"><i class="fab fa-instagram"></i></a></li>
                   <!-- <li><a href="https://api.whatsapp.com/send?phone=919496947548&amp;text=BKMEET%20-%20Confirmed%20Online%20Appointment" target="_new"><i class="fab fa-whatsapp"></i></a></li>
                   <li><a href="https://youtube.com/@BKMEET" target="_new"><i class="fab fa-youtube" target="_new"></i></a></li>
                   <li><a href="https://play.google.com/store/apps/dev?id=4852298828600166862" target="_new"><i class="fab fa-android" target="_new"></i></a></li> -->
               </ul>
           </div><br>
           <!-- <p>
               <a href="https://play.google.com/store/apps/details?id=com.BKMEET.app" target="_new" title="BKMEET mobile app now available on Google playstore">
                   <img src="https://www.BKMEET.com/img/bnm/google-play-badge-bnm-vc-01.svg" width="120" height="36" alt="BKMEET mobile app now available on Google playstore" class="img-fluid">
               </a>
           </p> -->
           
       </div>
       <div class="col-lg-3 col-md-4">
       
           <!-- <ul class="links">
           <li><a href="/clinicalprocedures">Clinical Procedure Scheduling</a></li>
           <li><a href="/vaccination">Vaccination</a></li>
           <li><a href="/nutritionpractice">Nutrition Practice</a></li>
           <li><a href="/compareplans">Compare Plans</a></li>
               <li><a href="/terms">Terms of Use</a></li>
               <li><a href="/privacy">Privacy Policy</a></li>
               <li><a href="/personalinformationpolicy">Personal Information Policy</a></li>
               <li><a href="/videoconsultationpolicy">Video Consultation Policy</a></li>
               <li><a href="/trademarknotice">Trade Mark Notice</a></li>
               <li><a href="/faq">FAQ</a></li>
               
               <li><a href="/limitedoffer">Special Offer</a></li>
           </ul> -->
           <p>Subscribe to BKMEET Newsletter to get Important News, Amazing Offers &amp; Inside Scoops:</p>
            <form method="post" action="" class="rd-mailform subscribe" id="subscription_mail" data-parsley-validate="" novalidate="">
                <input type="hidden" name="form-type" value="subscribe">
                <input id="email_id" name="email_id" data-parsley-trigger="change" required="" type="email" class="form-control" placeholder="Email">
                <br>
                <!-- <input type="submit" class="btn_1" value="Submit"><div class="mfInfo"></div>												  -->
            </form>
       </div>
          
       <!-- <div class="col-lg-5 col-md-5" id="homepagesection">
           <a class="btn btn-sm btn-primary" href="https://www.BKMEET.com/demo">Request BKMEET Demo</a>
           <a class="btn btn-sm btn-primary" href="https://www.BKMEET.com/career">Career@BKMEET</a>
           <a class="btn btn-sm btn-primary" href="https://www.BKMEET.com/webstories/bnm-amp-stories.html">WEBSTORIES</a>
           <h5 style="margin-top: 20px;">Your guaranteed Mobile Online Appointment</h5>
           <p>With BKMEET productivity tool, be successful in avoiding unscheduled absences. let our tool support you to be a leader in your medical practice. The best online appointment scheduling Platform enhances your practice management with online profile visibility.</p>
           
       </div> -->
       
    </div>
    <br><br>
    <!--/row-->
    <div class="row">
       <div class="col-md-12">
                         </div>
    </div>
    <br>
    <!-- <div class="row">
       <div class="col-md-12">
       
           <p>
               <a target="_blank" href="http://www.newindianexpress.com/cities/kochi/2017/feb/08/book-n-meet-a-doctor-1568476.html"><img style="width:168px;height:21px;margin-right:25px;" alt="BKMEET startup based in Kochi featured by National media,The New IndianExpress-Startupedia" class="img-fluid" src="https://www.BKMEET.com/img/theNewIndianExpress-BKMEET-2020.png"></a>
               
               <a target="_blank" href="http://epaperbeta.timesofindia.com/Article.aspx?eid=31811&amp;articlexml=Startups-wake-up-to-new-avenues-30072017002046"><img style="width: 165px;height:21px;margin-right:25px" alt="BKMEET startup based in Kochi featured by National media,The Times of India-TOI-Startup feature by local correspondant" class="img-fluid" src="https://www.BKMEET.com/img/theTimesofIndia-BKMEET-2020.png"></a>
               
               <a target="_blank" href="https://www.vanitha.in/justin/book-in-meet-prashanthi-nadhan-article-vanitha.html"><img style="width: 127px;height:36px;" alt="BKMEET startup based in Kochi featured by National media,Vanitha-Startup feature by local correspondant" class="img-fluid" src="https://www.BKMEET.com/img/Vanitha-Manorama-BKMEET-2020.png"></a>
           
           </p>
       
       </div>
    
    </div> -->
    <hr>
    <div class="row">
       <!-- <div class="col-md-8">
           <ul id="additional_links">
               <li><a href="https://qstat.co" target="_new" title="BKMEET QMS WITH TOKEN">QSTAT</a></li>
               <li><a href=" http://startups.startupmission.in/c/460" class="text-transform-none" target="_blank" title="Kerala Startup Mission Certified Startup">KSUM</a></li>
               <li><a href="https://www.startupindia.gov.in/content/sih/en/profile.Startup.59807990e4b0bed982a4ed5c.html" class="text-transform-none" target="_blank" title="Govt. of India Certified Startup">STARTUPINDIA</a></li>
           </ul>
       </div> -->
       <div class="col-md-4">
           <div id="copy">Copyright © 2024 All Rights Reserved by <a href="./index1.html">BKMEET®</a></div>
       </div>
    </div>
    </div>
    </footer>
</body>

<script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-database.js"></script>
<script src="index1.js"></script>


<script>

document.getElementById("LOGOUT").addEventListener("click", logout);

document.addEventListener("DOMContentLoaded", function(){
    checkLoginStatus()
})

function checkLoginStatus(){
    
        firebase.auth().onAuthStateChanged(async function(user){
            if(user){
                document.getElementById("LOGIN").style.display = 'none'
                document.getElementById("REGISTER").style.display = 'none'
            }
            else {
                document.getElementById("LOGIN").style.display = 'block'
                document.getElementById("REGISTER").style.display = 'block'
                window.location.href = "index1.html"
            }
        })
    
}

document.getElementById("bhyt").addEventListener('change', function(){
    if (document.getElementById('bhyt').value === 'yes'){
        document.getElementById('numberHI').style.display = "block"
    } else if (document.getElementById('bhyt').value === 'no') {
        document.getElementById('numberHI').style.display = "none"
    }
})
function setAppointment(){
    

  fullName = document.getElementById('full_name21').value
  gender = document.getElementById('gender').value
  age = document.getElementById('age').value
  phoneNumber = document.getElementById('number').value
  address = document.getElementById('address').value
  bhyt = document.getElementById('bhyt').value
  khoa = document.getElementById('khoa').value 
  time = document.getElementById('time').value
  date = document.getElementById('date').value
  numberHI = document.getElementById('numberHI').value

  database.ref('doctorList/' + khoa).once('value', function(doctorSnapshot) {
    const NumberDoctor = doctorSnapshot.numChildren();
    

    const conditions = [
        {name: "Clinic", value: khoa},
        {name: "Date", value: date},
        {name: "Time", value: time}
    ];

    let query = database.ref('Appointment');
    
    // Thêm orderByChild cho trường Clinic
    query = query.orderByChild('Clinic').equalTo(khoa);

    query.once('value', function(appointmentSnapshot) {
        const appointments = appointmentSnapshot.val();
        console.log(appointments)
        let count = 0;
        if (appointments) {
            // Kiểm tra cả trường Clinic và Date cùng một lúc
            Object.keys(appointments).forEach(key => {
                const appointment = appointments[key];
                if (appointment.Date === date && appointment.Time == time ) {
                    count++;
                }
            });
        }
        console.log("Number of appointments in the clinic and date: " + count);
        console.log("Number of doctors in the clinic: " + NumberDoctor);
        if(count === NumberDoctor){
            console.log('full')
            return
        } else {
            console.log("success")
            var data = {
      FullName: fullName,
      Gender: gender,
      Age: age,
      PhoneNumber: phoneNumber,
      Address: address,
      Clinic: khoa,
      HealthInsurance: bhyt,
      NumberHealthInsurance: numberHI,
      Time: time,
      Date: date
      
  }
  firebase.database().ref('Appointment/'+ phoneNumber).update(data)
  .then(()=>{
      alert('Submit successfully')
  }

  )
        }
    });
}, function(error) {
    console.error("Error fetching doctors:", error);
});



  
}
function logout(){
    firebase.auth().signOut().then(function(){
        console.log("User signed out")
    }).catch(function(error){
        console.error("Error signing out", error)
})
}

</script>

</html>